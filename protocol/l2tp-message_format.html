
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

<meta name="DC.Title" content="L2TP报文格式">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="DC.Relation" scheme="URI" content="../message/application-layer.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="icmp_message_format_1">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<title>L2TP报文格式</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="icmp_message_format_1"></a><a name="icmp_message_format_1"></a>


<h1 class="topictitle1">L2TP报文格式</h1>


<div><p></p>

<div class="section"><h4 class="sectiontitle">报文格式</h4><p>L2TP的控制消息和数据消息使用相同的报文头。 </p>
<span><img src="image/L2TP-format.png"></span><p>L2TP报文头中标记为可选（opt）的字段，是指在数据消息中可选，在控制消息中则是必选的。 </p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="7.333333333333333%" id="mcps1.3.1.5.1.4.1.1">字段</th>

<th class="cellrowborder" valign="top" width="16.333333333333332%" id="mcps1.3.1.5.1.4.1.2">长度</th>

<th class="cellrowborder" valign="top" width="76.33333333333333%" id="mcps1.3.1.5.1.4.1.3">描述</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">T</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">1比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">类型（Type），取值为“0”时表示数据消息，取值为“1”时表示控制消息。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">L</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">1比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">长度在位标志，取值为“1”时表示报文头中存在长度字段Length。控制消息中必须为“1”。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">x</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">1比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">保留位</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">S</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">1比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">顺序字段在位标志，取值为“1”时表示报文头中存在Ns和Nr字段。控制消息中必须为“1”。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">O</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">1比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">取值为“1”时表示报文头中存在offset size字段。控制消息中必须为“0”。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">P</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">1比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">优先级（Priority），只用于数据消息。控制消息中必须为“0”。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Ver</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">4比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">版本号，对于L2TPv2协议取值为“2”。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Length</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">消息的总长度，单位为字节。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Tunnel ID</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">隧道标识符，只具有本地意义。Hello控制消息具有全局性，其Tunnel ID必须为0。  </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Session ID</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">会话标识符，只具有本地意义。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Ns</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">当前消息的顺序号。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Nr</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">希望接收的下一条控制消息的顺序号。数据消息中是保留字段。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Offset size</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">偏移值，指示载荷数据开始的位置。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="7.333333333333333%" headers="mcps1.3.1.5.1.4.1.1 ">Offset padding</td>

<td class="cellrowborder" valign="top" width="16.333333333333332%" headers="mcps1.3.1.5.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="76.33333333333333%" headers="mcps1.3.1.5.1.4.1.3 ">填充位。</td>

</tr>

</tbody>

</table>
</div>
</div>

<div class="section"><h4 class="sectiontitle">Packet Example</h4><div class="fignone"><span class="figcap"><b>图1 </b>L2TP Control Message</span>

<br><span><img src="image/L2TP-example_control.png"></span></div>
<div class="fignone"><span class="figcap"><b>图2 </b>L2TP Data Message</span>

<br><span><img src="image/L2TP-example_data.png"></span></div>
</div>

<div class="section"><h4 class="sectiontitle">参考标准</h4>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="50%" id="mcps1.3.3.2.1.3.1.1">标准</th>

<th class="cellrowborder" valign="top" width="50%" id="mcps1.3.3.2.1.3.1.2">描述</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.3.2.1.3.1.1 ">RFC 2661</td>

<td class="cellrowborder" valign="top" width="50%" headers="mcps1.3.3.2.1.3.1.2 ">Layer Two Tunneling Protocol "L2TP"</td>

</tr>

</tbody>

</table>
</div>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="application-layer.html">应用层</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">本资料收集于互联网</div><div class="hwcopyright">2016 &copy</div></body>
</html>