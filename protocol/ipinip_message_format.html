
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

<meta name="DC.Title" content="IP in IP报文格式">
<meta name="DC.Relation" scheme="URI" content="../message/network-layer.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ip_message_format_1">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<title>IP in IP报文格式</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="ip_message_format_1"></a><a name="ip_message_format_1"></a>


<h1 class="topictitle1">IP in IP报文格式</h1>

<div>
<div class="section"><h4 class="sectiontitle">报文格式</h4><div class="fignone"><span class="figcap"><b>图1 </b>IPinIP报文格式</span>

<br><span><img src="image/IPinIP-format.png"></span></div>
<p>其中，内层IPv4头部和普通IPv4报文头部相同，IPv4报文头详细解释请参见<a href="ip_message_format.html">IPv4报文格式</a>。外层IPv4头部处理如下：</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="18.5%" id="mcps1.2.1.4.1.3.1.1">字段</th>

<th class="cellrowborder" valign="top" width="81.5%" id="mcps1.2.1.4.1.3.1.2">含义</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Version</td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">=4 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">IHL </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">指外层IP头部长度，以32比特为计算单位。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">TOS </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">从内层IP头部复制。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Total Length </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">指整个IP负载的长度，包括外层IP头，内层IP头和IP负载。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Identification, Flags, Fragment Offset</td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">这三个字段的含义与RFC791的定义相同。注意，如果内层IP头部的DF位置位，外层IP头部的DF位也必须置位。如果内层IP头的DF未置位，外层IP头部的DF位可以置位也可以不置位。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Time to Live </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">外层IP头部的TTL域设置为发送该数据包到隧道目的端的合适的值。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Protocol </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">=4 </td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Header Checksum </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">外层IP头部的校验字段。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Source Address</td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">执行该IPinIP隧道头封装的隧道入口设备的IP地址。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Destination Address </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">执行该IPinIP隧道头解封装的隧道出口设备的IP地址。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="18.5%" headers="mcps1.2.1.4.1.3.1.1 ">Options </td>

<td class="cellrowborder" valign="top" width="81.5%" headers="mcps1.2.1.4.1.3.1.2 ">内层IP头部的任何选项字段通常不被复制到外层IP头部。隧道路径上的设备可以添加新的选项字字段。内层IP头部的安全选项字段的类型可能影响外层IP头部的安全选项字段的选择。</td>

</tr>

</tbody>

</table>
</div>
</div>

<div class="section"><h4 class="sectiontitle">报文示例</h4><div class="fignone"><span class="figcap"><b>图2 </b>IP in IP报文</span>

</div>
<span><img src="image/IPinIP-example.png"></span></div>

<div class="section"><h4 class="sectiontitle">参考标准</h4>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">


<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="16%" id="mcps1.2.3.2.1.3.1.1">标准</th>

<th class="cellrowborder" valign="top" width="84%" id="mcps1.2.3.2.1.3.1.2">描述</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="16%" headers="mcps1.2.3.2.1.3.1.1 ">RFC 2003</td>

<td class="cellrowborder" valign="top" width="84%" headers="mcps1.2.3.2.1.3.1.2 ">IP Encapsulation within IP</td>

</tr>

</tbody>

</table>
</div>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="network-layer.html">网络层</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">本资料收集于互联网</div><div class="hwcopyright">2016 &copy</div></body>
</html>