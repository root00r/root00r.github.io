
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

<meta name="DC.Title" content="ARP/RARP报文格式">
<meta name="abstract" content="">
<meta name="description" content="">
<meta name="DC.Relation" scheme="URI" content="../message/network-layer.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="arp_rarp_message_format">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<title>ARP/RARP报文格式</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="arp_rarp_message_format"></a><a name="arp_rarp_message_format"></a>


<h1 class="topictitle1">ARP/RARP报文格式</h1>


<div><p></p>

<p>地址解析协议ARP（Address Resolution Protocol）是用来将IP地址解析为MAC地址的协议。</p>

<div class="section"><h4 class="sectiontitle">报文格式</h4><span><img src="image/ARP_format.png"></span>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="23.41137123745819%" id="mcps1.3.2.3.1.4.1.1">字段</th>

<th class="cellrowborder" valign="top" width="8.361204013377927%" id="mcps1.3.2.3.1.4.1.2">长度（bit）</th>

<th class="cellrowborder" valign="top" width="68.22742474916387%" id="mcps1.3.2.3.1.4.1.3">含义</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Ethernet Address of destination</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">48比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">目的以太网地址。发送ARP请求时，为广播的MAC地址，0xFF.FF.FF.FF.FF.FF。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Ethernet Address of sender</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">48比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">源以太网地址。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Frame Type</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">表示后面数据的类型。对于ARP请求或应答来说，该字段的值为0x0806。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Hardware Type</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">表示硬件地址的类型。对于以太网，该类型的值为“1”。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Protocol Type</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">表示发送方要映射的协议地址类型。对于IP地址，该值为0x0800。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Hardware Length</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">8比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">表示硬件地址的长度，单位是字节。对于ARP请求或应答来说，该值为6。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Protocol Length</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">8比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">表示协议地址的长度，单位是字节。对于ARP请求或应答来说，该值为4。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">OP</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">16比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">操作类型:<ul><li>1     ARP请求</li><li>2     ARP应答</li><li>3     RARP请求</li><li>4     RARP应答</li></ul>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Ethernet Address of sender</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">48比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">发送方以太网地址。这个字段和ARP报文首部的源以太网地址字段是重复信息。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">IP Address of sender</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">32比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">发送方的IP地址。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">Ethernet Address of destination</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">48比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">接收方的以太网地址。发送ARP请求时，该处填充值为0x00.00.00.00.00.00。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="23.41137123745819%" headers="mcps1.3.2.3.1.4.1.1 ">IP Address of destination</td>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.3.2.3.1.4.1.2 ">32比特</td>

<td class="cellrowborder" valign="top" width="68.22742474916387%" headers="mcps1.3.2.3.1.4.1.3 ">接收方的IP地址。</td>

</tr>

</tbody>

</table>
</div>
</div>

<div class="section"><h4 class="sectiontitle">报文示例</h4><div class="fignone"><span class="figcap"><b>图1 </b>免费ARP报文格式</span>

<br><span><img src="image/ARP_Free.png"></span></div>
<div class="fignone"><span class="figcap"><b>图2 </b>ARP请求报文格式</span>

<br><span><img src="image/ARP_request.png"></span></div>
<div class="fignone"><span class="figcap"><b>图3 </b>ARP应答报文格式</span>

<br><span><img src="image/ARP_reply.png"></span></div>
<div class="fignone"><span class="figcap"><b>图4 </b>RARP请求报文格式</span>

<br><span><img src="image/ARP_RARP-request.png"></span></div>
</div>

<div class="section"><h4 class="sectiontitle">参考标准</h4>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="18%" id="mcps1.3.4.2.1.3.1.1">标准</th>

<th class="cellrowborder" valign="top" width="82%" id="mcps1.3.4.2.1.3.1.2">描述</th>

</tr>

</thead>

<tbody>
<tr>

<td class="cellrowborder" valign="top" width="18%" headers="mcps1.3.4.2.1.3.1.1 ">RFC 826</td>

<td class="cellrowborder" valign="top" width="82%" headers="mcps1.3.4.2.1.3.1.2 ">Ethernet Address Resolution Protocol</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="18%" headers="mcps1.3.4.2.1.3.1.1 ">RFC 903</td>

<td class="cellrowborder" valign="top" width="82%" headers="mcps1.3.4.2.1.3.1.2 ">Reverse Address Resolution Protocol</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="18%" headers="mcps1.3.4.2.1.3.1.1 ">RFC 1027</td>

<td class="cellrowborder" valign="top" width="82%" headers="mcps1.3.4.2.1.3.1.2 ">Using ARP to Implement Transparent Subnet Gateways</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="18%" headers="mcps1.3.4.2.1.3.1.1 ">RFC 1042</td>

<td class="cellrowborder" valign="top" width="82%" headers="mcps1.3.4.2.1.3.1.2 ">Standard for the Transmission of IP Datagrams over IEEE 802
Networks</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="18%" headers="mcps1.3.4.2.1.3.1.1 ">RFC 5227</td>

<td class="cellrowborder" valign="top" width="82%" headers="mcps1.3.4.2.1.3.1.2 ">IPv4 Address Conflict Detection</td>

</tr>

</tbody>

</table>
</div>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="network-layer.html">网络层</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">本资料收集于互联网</div><div class="hwcopyright">2016 &copy</div></body>
</html>