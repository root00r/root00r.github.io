
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">

<meta name="DC.Title" content="RPR帧格式">
<meta name="DC.Relation" scheme="URI" content="../message/link-layer.html">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="rrpp_message_format_11">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="../public_sys-resources/commonltr.css">
<title>RPR帧格式</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="rrpp_message_format_11"></a><a name="rrpp_message_format_11"></a>


<h1 class="topictitle1">RPR帧格式</h1>

<div>
<p>RPR有4种帧格式，包括：（1）基本数据帧（2）控制帧（3）公平算法帧（4）Idle帧。</p>

<div class="section"><h4 class="sectiontitle">基本数据帧</h4><span><img src="image/RPR-format-general.png"></span><p>RPR基本数据帧中几个主要字段的含义：</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="8.361204013377927%" id="mcps1.2.2.4.1.4.1.1">字段</th>

<th class="cellrowborder" valign="top" width="6.688963210702341%" id="mcps1.2.2.4.1.4.1.2">长度（字节）</th>

<th class="cellrowborder" valign="top" width="84.94983277591973%" id="mcps1.2.2.4.1.4.1.3">描述</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">TTL</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">1</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">TTL（Time to Live），TTL的值决定数据帧在RPR环网上被转发的最大跳数。每经过一个节点，TTL值被减1，当TTL等于0时，数据帧被丢弃。这种机制可以防止数据帧在环网上被无限制的循环转发。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">基本环控制</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">1</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">包含选环信息、公平算法控制信息、帧类型、流类型（服务级别）、Wrap控制信息和奇偶校验位。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">目的MAC地址</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">6</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">48位目的MAC地址。对于单播报文，该字段在目的节点被删除；对于多播报文，该字段在源节点被删除。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">源MAC地址</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">6</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">48位源MAC地址。发送数据的源站点的MAC地址，它在传送过程中一直保持不变，用于目的节点回应消息的地址。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">TTL基数</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">1</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">TTL的初始值。在数据帧转发过程中，TTL基数保持不变。用TTL基数减去TTL值，可以得到数据帧转发到当前节点经过的跳数。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">扩展环控制</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">1</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">RPR报文扩展头，扩展帧标志、泛洪标志、泛洪类型、通过源节点标志、严格顺序帧标志和保留位。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">HEC</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">2</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">HEC（Header Error Check），头部校验和，16位CRC（Cyclic Redundancy Check）校验。头部校验和是对TTL、基本控制信息、目的MAC地址、源MAC地址、TTL基数和扩展控制信息6个字段的数据进行计算而得到的。</td>

</tr>

<tr>

<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">协议类型</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">2</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">当此值小于1536（十进制）时表示帧的长度。当此值大于等于1536（十进制）时表示数据载荷的协议类型。“数据”字段承载的协议和“协议类型”字段的取值的对应关系如下：<ul><li>0x0800: IPv4</li><li>0x86dd: IPv6</li><li>0x8847: Tag Unicast</li><li>0x8848: Tag Multicast</li><li>0x0806: ARP (Address Resolution Protocol)</li></ul>
</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">用户数据</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">n</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">有效数据帧，此字段的长度是可变的。</td>

</tr>

<tr>
<td class="cellrowborder" valign="top" width="8.361204013377927%" headers="mcps1.2.2.4.1.4.1.1 ">FCS</td>

<td class="cellrowborder" valign="top" width="6.688963210702341%" headers="mcps1.2.2.4.1.4.1.2 ">4</td>

<td class="cellrowborder" valign="top" width="84.94983277591973%" headers="mcps1.2.2.4.1.4.1.3 ">FCS（Frame Check Sequence），帧校验序列，32位CRC校验。是对协议类型和数据两个字段进行CRC校验得到的。</td>

</tr>

</tbody>

</table>
</div>
</div>

<div class="section"><h4 class="sectiontitle">控制帧</h4><span><img src="image/RPR-format-control.png"></span><p>控制类型”字段的取值决定控制帧的类型。控制帧有10种类型，控制帧的类型与“控制类型”字段的取值的对应关系：</p>
<ul><li>0x01: Attribute Discovery（ATD），节点属性发现帧。</li><li>0x02: Topology and Protection packet（TP），拓扑与保护协议帧。</li><li>0x03: Topology Checksum（TC），拓扑校验帧。</li><li>0x04: Link round trip time measurement（LRTT） request，链路往返时间测量请求。</li><li>0x05: Link Round Trip Time measurement （LRTT） response，链路往返时间测量响应。</li><li>0x06: Fairness Differential Delay（FDD）</li><li>0x07: OAM echo request </li><li>0x08: OAM echo response</li><li>0x09: OAM flush</li><li>0x0A: OAM organization specific</li><li>All others: Reserved</li></ul>
</div>

<div class="section"><h4 class="sectiontitle">公平算法帧</h4><span><img src="image/RPR-format-fair.png"></span><p>公平算法帧格式中主要字段的解释如下：</p>
<ul><li>源MAC地址：当前节点或者拥塞节点的MAC地址。</li><li><p>公平算法头：</p>
<ul><li><p>Version＝0：Single Choke Fairness，每个公平算法周期发送一个，点对点传输。</p>
</li><li><p>Version＝1：Muti Choke Fairness，每10个公平算法周期发送一个，广播传输。</p>
</li></ul>
</li><li>FCS：32位CRC校验。校验时不包含TTL和基本环控制字段。 </li></ul>
</div>

<div class="section"><h4 class="sectiontitle">Idle帧</h4><span><img src="image/RPR-format-idle.png"></span><p>Idle帧用于调整节点间的速率同步，在相邻的两个节点之间进行点对点传输。</p>
<p>Idle负荷域默认为全0。 </p>
</div>

<div class="section"><h4 class="sectiontitle">参考标准</h4>
<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" frame="border" border="1" rules="all">
<thead align="left">
<tr>
<th class="cellrowborder" valign="top" width="18%" id="mcps1.2.6.2.1.3.1.1">标准</th>

<th class="cellrowborder" valign="top" width="82%" id="mcps1.2.6.2.1.3.1.2">描述</th>

</tr>

</thead>

<tbody>
<tr>
<td class="cellrowborder" valign="top" width="18%" headers="mcps1.2.6.2.1.3.1.1 ">IEEE P802.17-2004</td>

<td class="cellrowborder" valign="top" width="82%" headers="mcps1.2.6.2.1.3.1.2 ">IEEE Standard for information technology&#8212;Telecommunications
and information exchange between systems&#8212; Local and metropolitan area
networks&#8212;Specific requirements Part 17: Resilient packet ring (RPR)
access method and physical layer specifications</td>

</tr>

</tbody>

</table>
</div>
</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="link-layer.html">链路层</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">本资料收集于互联网</div><div class="hwcopyright">2016 &copy</div></body>
</html>